<% title = 'Users' %>


<h2>User Management</h2>

<form method="POST" action="/admin/users" class="mb-3">
  <div class="row">
    <div class="col">
      <input type="text" name="name" class="form-control" placeholder="Name" required />
    </div>
    <div class="col">
      <input type="email" name="email" class="form-control" placeholder="Email" required />
    </div>
    <div class="col">
      <input type="text" name="role" class="form-control" placeholder="Role (optional)" />
    </div>
    <div class="col">
      <button type="submit" class="btn btn-primary">Add User</button>
    </div>
  </div>
</form>

<table class="table table-bordered table-hover">
  <thead>
    <tr><th>Name</th><th>Email</th><th>Role</th><th>Created</th><th>Actions</th></tr>
  </thead>
  <tbody>
    <% users.forEach(user => { %>
      <tr>
        <form method="POST" action="/admin/users/<%= user._id %>/edit">
          <td><input type="text" name="name" value="<%= user.name %>" class="form-control" /></td>
          <td><input type="email" name="email" value="<%= user.email %>" class="form-control" /></td>
          <td><input type="text" name="role" value="<%= user.role || '' %>" class="form-control" /></td>
          <td><%= new Date(user.createdAt).toLocaleDateString() %></td>
          <td>
            <button class="btn btn-success btn-sm">Update</button>
        </form>
        <form method="POST" action="/admin/users/<%= user._id %>/delete" onsubmit="return confirm('Delete this user?')">
          <button class="btn btn-danger btn-sm">Delete</button>
        </form>
          </td>
      </tr>
    <% }) %>
  </tbody>
</table>
